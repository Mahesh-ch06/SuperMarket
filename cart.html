<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - FreshMart</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans:wght@400;500;700;900&display=swap">
    <style>
        body {
            font-family: 'Space Grotesk', 'Noto Sans', sans-serif;
        }
        /* Styles for the confirmation modal */
        .confirmation-modal {
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-[#f9fbfa]">

    <div class="relative flex min-h-screen flex-col">
        <!-- Header -->
        <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-solid border-b-[#eaf0ec] px-4 sm:px-10 py-3">
            <div class="flex items-center justify-between">
                <a href="index.html" class="flex items-center gap-3 text-[#111813]">
                    <div class="size-5">
                        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 42.4379C4 42.4379 14.0962 36.0744 24 41.1692C35.0664 46.8624 44 42.2078 44 42.2078L44 7.01134C44 7.01134 35.068 11.6577 24.0031 5.96913C14.0971 0.876274 4 7.27094 4 7.27094L4 42.4379Z" fill="currentColor"></path></svg>
                    </div>
                    <h1 class="text-[#111813] text-lg font-bold tracking-[-0.015em]">FreshMart</h1>
                </a>
                <a href="shop.html" class="flex min-w-[84px] cursor-pointer items-center justify-center rounded-xl h-10 px-4 bg-[#6ec88e] hover:bg-green-500 text-[#111813] text-sm font-bold tracking-[0.015em]">
                    <span>Continue Shopping</span>
                </a>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="flex-1">
            <!-- Cart content will be dynamically inserted here by JavaScript -->
        </main>

        <!-- Footer -->
        <footer class="bg-gray-50 border-t">
            <div class="max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8 text-center">
                <div class="flex justify-center gap-x-6 sm:gap-x-12 mb-6">
                    <a href="#" class="text-sm text-gray-600 hover:text-[#6ec88e]">About Us</a>
                    <a href="#" class="text-sm text-gray-600 hover:text-[#6ec88e]">Contact</a>
                    <a href="#" class="text-sm text-gray-600 hover:text-[#6ec88e]">Privacy Policy</a>
                    <a href="#" class="text-sm text-gray-600 hover:text-[#6ec88e]">Terms of Service</a>
                </div>
                <p class="text-sm text-gray-500">© 2025 FreshMart. All rights reserved.</p>
            </div>
        </footer>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="confirmation-modal fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center hidden opacity-0">
        <div class="bg-white rounded-lg shadow-xl p-6 w-11/12 max-w-sm text-center transform -translate-y-10">
            <p id="confirmation-message" class="text-lg font-medium text-[#111813] mb-4"></p>
            <div class="flex justify-center gap-4">
                <button id="confirm-btn" class="flex-1 rounded-xl h-10 px-4 bg-red-600 text-white text-sm font-bold hover:bg-red-700 transition-colors">Yes</button>
                <button id="cancel-btn" class="flex-1 rounded-xl h-10 px-4 bg-gray-200 text-[#111813] text-sm font-bold hover:bg-gray-300 transition-colors">No</button>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    let cartItems = [];
    const mainContent = document.getElementById('main-content');
    const confirmationModal = document.getElementById('confirmation-modal');
    const confirmationMessage = document.getElementById('confirmation-message');
    const confirmBtn = document.getElementById('confirm-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const modalContentElement = confirmationModal.querySelector('div'); // Get the inner modal content div
    
    let actionToConfirm = null;

    // Helper to open the confirmation modal with animation
    function openConfirmationModal(message, onConfirmCallback) {
        confirmationMessage.textContent = message;
        actionToConfirm = onConfirmCallback;
        confirmationModal.classList.remove('hidden');
        setTimeout(() => {
            confirmationModal.classList.remove('opacity-0');
            modalContentElement.classList.remove('-translate-y-10');
        }, 10);
    }

    // Helper to close the confirmation modal with animation
    function closeConfirmationModal() {
        confirmationModal.classList.add('opacity-0');
        modalContentElement.classList.add('-translate-y-10');
        setTimeout(() => {
            confirmationModal.classList.add('hidden');
            actionToConfirm = null;
        }, 300);
    }

    function loadCart() {
        const savedCart = localStorage.getItem('freshmartCart');
        cartItems = savedCart ? JSON.parse(savedCart) : [];
    }

    function saveCart() {
        localStorage.setItem('freshmartCart', JSON.stringify(cartItems));
    }
    
    function updateCart(productId, change) {
        const item = cartItems.find(i => i.id === productId);
        if (item) {
            item.quantity += change;
            if (item.quantity <= 0) {
                // remove item if quantity is 0 or less
                cartItems = cartItems.filter(i => i.id !== productId);
            }
        }
        saveCart();
        renderCart();
    }

    function removeItem(productId) {
        openConfirmationModal('Are you sure you want to remove this item?', () => {
            cartItems = cartItems.filter(i => i.id !== productId);
            saveCart();
            renderCart();
            closeConfirmationModal();
        });
    }

    function emptyCart() {
        openConfirmationModal('Are you sure you want to empty your cart?', () => {
            cartItems = [];
            saveCart();
            renderCart();
            closeConfirmationModal();
        });
    }

    function proceedToCheckout() {
        openConfirmationModal('Proceed to checkout with your current items?', () => {
            // In a real application, this would integrate with a payment gateway
            alert('Thank you for your order! This is a demo checkout.'); // Using alert as a placeholder for final confirmation
            cartItems = [];
            saveCart();
            renderCart();
            closeConfirmationModal();
        });
    }

    function renderCart() {
        loadCart(); // Load the latest cart data before rendering
        mainContent.innerHTML = ''; // Clear previous content

        if (cartItems.length === 0) {
            mainContent.innerHTML = `
                <div class="text-center py-20 px-4">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Your cart is empty</h2>
                    <p class="text-gray-500 mb-6">Looks like you haven't added anything to your cart yet.</p>
                    <a href="shop.html" class="inline-block rounded-xl h-12 px-8 bg-[#6ec88e] text-[#111813] text-base font-bold tracking-[0.015em] hover:bg-green-500 transition-colors">
                        Start Shopping
                    </a>
                </div>
            `;
            return;
        }

        let subtotal = 0;
        let cartListHTML = '';

        cartItems.forEach(item => {
            const itemTotal = item.price * item.quantity;
            subtotal += itemTotal;
            cartListHTML += `
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4 border-b py-4">
                    <div class="flex items-center gap-4 w-full sm:w-1/2">
                        <img src="${item.image}" alt="${item.name}" class="w-16 h-16 rounded-md object-cover">
                        <div>
                            <p class="font-medium text-gray-800">${item.name}</p>
                            <p class="text-sm text-gray-500">₹${item.price.toFixed(2)} / ${item.unit || 'unit'}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <button class="quantity-btn p-1 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors" data-id="${item.id}" data-change="-1">-</button>
                        <span class="w-8 text-center text-gray-800 font-medium">${item.quantity}</span>
                        <button class="quantity-btn p-1 rounded-full bg-gray-200 hover:bg-gray-300 transition-colors" data-id="${item.id}" data-change="1">+</button>
                    </div>
                    <p class="font-semibold w-24 text-right text-gray-800">₹${itemTotal.toFixed(2)}</p>
                    <button class="remove-btn text-red-500 hover:text-red-700 font-medium transition-colors" data-id="${item.id}">Remove</button>
                </div>
            `;
        });
        
        const grandTotal = subtotal; // Assuming no taxes/fees for now

        const cartPageHTML = `
            <div class="max-w-4xl mx-auto py-10 px-4">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Your Shopping Cart</h2>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div id="cart-items-container">
                        ${cartListHTML}
                    </div>
                    <div class="mt-6 flex flex-col items-end gap-4">
                            <div class="w-full sm:w-1/2 lg:w-1/3 space-y-2">
                                <div class="flex justify-between text-lg">
                                    <span class="font-medium text-gray-600">Subtotal:</span>
                                    <span class="font-semibold text-gray-800">₹${subtotal.toFixed(2)}</span>
                                </div>
                                <div class="flex justify-between text-xl border-t pt-2">
                                    <span class="font-bold text-gray-800">Grand Total:</span>
                                    <span class="font-bold text-gray-900">₹${grandTotal.toFixed(2)}</span>
                                </div>
                            </div>
                        <div class="flex w-full sm:w-auto gap-4 mt-4">
                            <button id="empty-cart-btn" class="w-full sm:w-auto rounded-xl h-12 px-6 bg-red-100 text-red-700 font-bold hover:bg-red-200 transition-colors">Empty Cart</button>
                            <button id="checkout-btn" class="w-full sm:w-auto rounded-xl h-12 px-6 bg-[#6ec88e] text-[#111813] font-bold hover:bg-green-500 transition-colors">Proceed to Checkout</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        mainContent.innerHTML = cartPageHTML;
        addCartActionListeners();
    }

    function addCartActionListeners() {
        document.querySelectorAll('.quantity-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const id = parseInt(e.currentTarget.dataset.id);
                const change = parseInt(e.currentTarget.dataset.change);
                updateCart(id, change);
            });
        });

        document.querySelectorAll('.remove-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const id = parseInt(e.currentTarget.dataset.id);
                removeItem(id);
            });
        });

        document.getElementById('empty-cart-btn')?.addEventListener('click', emptyCart);
        document.getElementById('checkout-btn')?.addEventListener('click', proceedToCheckout);
    }
    
    // Confirmation Modal Listeners
    confirmBtn.addEventListener('click', () => {
        if(actionToConfirm) {
            actionToConfirm();
        }
    });

    cancelBtn.addEventListener('click', () => {
        closeConfirmationModal();
    });

    // Initial Render
    renderCart();
});
</script>
</body>
</html>
