<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Authentication - FreshMart</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans:wght@400;500;700;900&display=swap">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/phone-auth.css">
</head>
<body class="bg-[#f9fbfa] bg-pattern min-h-screen">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b border-[#eaf0ec] px-4 sm:px-10 py-3">
        <div class="flex items-center justify-between max-w-6xl mx-auto">
            <a href="index.html" class="flex items-center gap-3 text-[#111813]">
                <div class="size-5">
                    <svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 42.4379C4 42.4379 14.0962 36.0744 24 41.1692C35.0664 46.8624 44 42.2078 44 42.2078L44 7.01134C44 7.01134 35.068 11.6577 24.0031 5.96913C14.0971 0.876274 4 7.27094 4 7.27094L4 42.4379Z" fill="currentColor"></path>
                    </svg>
                </div>
                <h1 class="text-[#111813] text-lg font-bold tracking-[-0.015em]">FreshMart</h1>
            </a>
            <a href="login.html" class="text-sm text-gray-600 hover:text-[#6ec88e] transition-colors">
                ← Back to Login
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex items-center justify-center px-4 py-12">
        <div class="w-full max-w-md">
            <!-- Welcome Section -->
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-[#6ec88e] rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="white" class="w-8 h-8">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
                    </svg>
                </div>
                <h2 class="text-3xl font-bold text-[#111813] mb-2">Phone Verification</h2>
                <p class="text-gray-600">Sign in with your phone number</p>
            </div>

            <!-- Auth Container -->
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <!-- Step Indicator -->
                <div class="step-indicator">
                    <div id="step1" class="step active">1</div>
                    <div class="step-line" id="line1"></div>
                    <div id="step2" class="step">2</div>
                </div>

                <!-- Debug Info -->
                <div class="debug-info" id="debugInfo">
                    Initializing Firebase...
                </div>

                <!-- Step 1: Phone Number Input -->
                <div id="phoneStep" class="form-step active">
                    <h3 class="text-xl font-semibold text-[#111813] mb-6 text-center">Enter Your Phone Number</h3>
                    
                    <form id="phoneForm" class="space-y-6">
                        <div>
                            <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-2">
                                Phone Number
                            </label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 text-sm">+91</span>
                                </div>
                                <input 
                                    type="tel" 
                                    id="phoneNumber" 
                                    maxlength="10" 
                                    placeholder="Enter 10-digit mobile number"
                                    value="7013295712"
                                    class="form-input w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#6ec88e] focus:border-transparent transition-all"
                                    pattern="[6-9][0-9]{9}"
                                    required
                                >
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Enter a valid Indian mobile number (starting with 6-9)</p>
                            <p id="phoneError" class="text-red-500 text-xs mt-1 hidden"></p>
                        </div>

                        <!-- reCAPTCHA Container -->
                        <div id="recaptcha-container"></div>

                        <button 
                            type="submit" 
                            id="sendOtpBtn"
                            disabled
                            class="w-full bg-[#6ec88e] hover:bg-green-500 text-white font-bold py-3 px-4 rounded-xl transition-all duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            <span>Send OTP</span>
                        </button>
                    </form>
                </div>

                <!-- Step 2: OTP Verification -->
                <div id="otpStep" class="form-step hidden">
                    <h3 class="text-xl font-semibold text-[#111813] mb-6 text-center">Verify OTP</h3>
                    
                    <div class="text-center mb-6">
                        <p class="text-gray-600 mb-2">We've sent a 6-digit code to</p>
                        <p class="font-semibold text-[#111813]" id="displayPhoneNumber">+91 XXXXXXXXXX</p>
                        <button id="changeNumberBtn" class="text-sm text-[#6ec88e] hover:text-green-600 mt-2">
                            Change number
                        </button>
                    </div>

                    <form id="otpForm" class="space-y-6">
                        <div>
                            <label for="otp" class="block text-sm font-medium text-gray-700 mb-2">
                                Enter OTP
                            </label>
                            <input 
                                type="text" 
                                id="otp" 
                                maxlength="6" 
                                placeholder="Enter 6-digit OTP"
                                class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#6ec88e] focus:border-transparent transition-all text-center text-lg tracking-widest"
                                pattern="[0-9]{6}"
                                required
                            >
                            <p id="otpError" class="text-red-500 text-xs mt-1 hidden"></p>
                        </div>

                        <div class="text-center">
                            <p class="text-sm text-gray-600 mb-2">Didn't receive the code?</p>
                            <button type="button" id="resendOtpBtn" class="text-sm text-[#6ec88e] hover:text-green-600 font-medium disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                Resend OTP (<span id="countdown">30</span>s)
                            </button>
                        </div>

                        <button 
                            type="submit" 
                            id="verifyOtpBtn"
                            disabled
                            class="w-full bg-[#6ec88e] hover:bg-green-500 text-white font-bold py-3 px-4 rounded-xl transition-all duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            <span>Verify & Sign In</span>
                        </button>
                    </form>
                </div>

                <!-- Back Button -->
                <div class="mt-6 text-center">
                    <button 
                        id="backBtn"
                        class="text-gray-600 hover:text-[#6ec88e] font-medium transition-colors"
                    >
                        ← Back to Login Options
                    </button>
                </div>
            </div>

            <!-- Footer Text -->
            <p class="text-center text-sm text-gray-500 mt-8">
                By continuing, you agree to our 
                <a href="#" class="text-[#6ec88e] hover:text-green-600">Terms of Service</a> 
                and 
                <a href="#" class="text-[#6ec88e] hover:text-green-600">Privacy Policy</a>
            </p>
        </div>
    </main>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script src="js/common.js"></script>
    <script src="js/phone-auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            window.FreshMartPhoneAuth.initializePhoneAuthPage();
        });
    </script>
</body>
</html>